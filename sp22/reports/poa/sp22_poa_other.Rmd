---
title: "poa other"
author: "Arielle Herman"
date: "4/10/2022"
output:
  pdf_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
source("../../code/default_setup.R")
```

Other

# 8.1)Households with income above the median are most likely to give high ratings to the response of State & Federal Government 

1.	Find proportion of people who gave a high rating to State & Federal Government [31]
a.	Find subset of population who have above median income [13]
b.	Compare the groups below and above median income groups on the basis of their participation in political advocacy.

```{r}
wrangled %>% summarize(across(contains("inc_ab_med"), mean, na.rm = TRUE))
make_plots(wrangled, c("inc_ab_med_before", "inc_ab_med_after", "inc_ab_med"), "rate_gov_all_good", title = "Rated Government Well", show = TRUE)
```

# 8.2)People with below median income were more likely to give low ratings to the responses of dr State & Federal Government 

1.Find proportion of people who gave a low rating to State & Federal Government [31]
a.	Find subset of population who have below median income [13]
b.	Compare the groups below and above median income groups on the basis on their participation in political advocacy.

```{r}
wrangled %>% summarize(across(contains("inc_be_med"), mean, na.rm = TRUE))

make_plots(wrangled, "inc_be_med", "rate_gov_all_bad", title = "Rated Government (Very) Poorly")
```

# 8.3)Find source of aid for all these requirements[33]

1.	Find proportion of respondents which look towards other sources for each of these categories 
(i) Local Transport
(ii) Utilities
(iii) Healthcare
(iv)Food 
(v) Clean Water 
vi) Adultcare
(vii)Childcare
(viii)Stress or Emotional Support

2.	Run distribution over each help source from Government, Friends and Family, Community Organizations, Corporate/Business, Faith-Based
3.	Run sub demographics by each category

```{r}
wrangled %>% select(starts_with("lr_"))

df <- wrangled %>% mutate(across(starts_with("lr_") & is.labelled, as.integer)) %>%
  pivot_longer(is.integer & starts_with("lr_")) %>%
  select(name,value) %>%
  mutate(name = str_replace(name, "lr_", "")) %>%
  filter(str_detect(name, "_")) %>%
  separate(name, into = c("area", "resource")) %>%
  group_by(area, resource) %>%
  summarize(n = sum(value, na.rm = TRUE)) %>%
  group_by(area) %>% #mutate(denom = sum(n)) %>%
  arrange(area, desc(n)) %>%
  #filter(row_number() <= 1) #%>%
  ungroup() %>% data.frame()


plot_1 <- ggplot(df, aes(x = resource, y = n)) + geom_bar(stat = "identity") + facet_wrap(~area, ncol = 3) + theme(axis.text.x = element_text(angle = 90))

plot_1

```
```{r}
make_plots(wrangled, by_vars = demographics, hyp_var = c("lr_cc_corp", "lr_cc_fam", "lr_cc_fb", "lr_cc_gov", "lr_cc_np"), title = "lr_cc")
```
```{r}
make_plots(wrangled, by_vars = demographics, hyp_var = c("lr_ec_corp", "lr_ec_fam", "lr_ec_fb", "lr_ec_gov", "lr_ec_np"), title = "lr_ec")

```
```{r}
make_plots(wrangled, by_vars = demographics, hyp_var = c("lr_food_corp", "lr_food_fam", "lr_food_fb", "lr_food_gov", "lr_food_np"), title = "lr_food")

```
```{r}
make_plots(wrangled, by_vars = demographics, hyp_var = c("lr_hc_corp", "lr_hc_fam", "lr_hc_fb", "lr_hc_gov", "lr_hc_np"), title = "lr_hc")

```

```{r}
make_plots(wrangled, by_vars = demographics, hyp_var = c("lr_stress_corp", "lr_stress_fam", "lr_stress_fb", "lr_stress_gov", "lr_stress_np"), title = "lr_stress")

```

```{r}
make_plots(wrangled, by_vars = demographics, hyp_var = c("lr_trans_corp", "lr_trans_fam", "lr_trans_fb", "lr_trans_gov", "lr_trans_np"), title = "lr_trans")

```

```{r}
make_plots(wrangled, by_vars = demographics, hyp_var = c("lr_util_corp", "lr_util_fam", "lr_util_fb", "lr_util_gov", "lr_util_np"), title = "lr_util")

```

```{r}
make_plots(wrangled, by_vars = demographics, hyp_var = c("lr_wtr_corp", "lr_wtr_fam", "lr_wtr_fb", "lr_wtr_gov", "lr_wtr_np"), title = "lr_wtr")

```
#Demographic plots here omitted if they do not show more than one statistically significant result.
